{"version":3,"sources":["../../../../../../src/webgpu/api/validation/encoding/cmds/copyTextureToTexture.spec.ts"],"names":["description","poptions","params","makeTestGroup","kAllTextureFormatInfo","kAllTextureFormats","kCompressedTextureFormats","kDepthStencilFormats","kTextureUsages","align","ValidationTest","F","TestCopyTextureToTexture","source","destination","copySize","isSuccess","commandEncoder","device","createCommandEncoder","copyTextureToTexture","expectValidationError","finish","GetPhysicalSubresourceSize","textureSize","format","mipLevel","virtualWidthAtLevel","Math","max","width","virtualHeightAtLevel","height","physicalWidthAtLevel","blockWidth","physicalHeightAtLevel","blockHeight","depthOrArrayLayers","g","test","fn","t","validTexture","createTexture","size","usage","GPUTextureUsage","COPY_SRC","COPY_DST","errorTexture","getErrorTexture","texture","srcLevelCount","dstLevelCount","srcCopyLevel","dstCopyLevel","srcTexture","mipLevelCount","dstTexture","combine","srcUsage","dstUsage","srcSampleCount","dstSampleCount","sampleCount","x","y","z","expand","p","srcCopyOrigin","dstCopyOrigin","copyWidth","copyHeight","kWidth","kHeight","origin","srcFormat","dstFormat","srcFormatInfo","dstFormatInfo","selectDeviceOrSkipTestCase","feature","kTextureSize","copyBoxOffsets","srcTextureSize","dstTextureSize","kMipLevelCount","srcSizeAtLevel","dstSizeAtLevel","copyOrigin","min","kFormat","copyDepth","srcCopyOriginZ","dstCopyOriginZ","copyExtentDepth","kArrayLayerCount","testTexture","desc","sourceAspect","destinationAspect","kValidAspectsForFormat","rgba8unorm","depth24plus","depth32float","stencil8","depth16unorm","isSourceAspectValid","includes","isDestinationAspectValid","aspect","texelBlockWidth","texelBlockHeight","isSuccessForCompressedFormats"],"mappings":"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","sourcesContent":["export const description = `\ncopyTextureToTexture tests.\n\nTest Plan: (TODO(jiawei.shao@intel.com): add tests on 1D/3D textures)\n* the source and destination texture\n  - the {source, destination} texture is {invalid, valid}.\n  - mipLevel {>, =, <} the mipmap level count of the {source, destination} texture.\n  - the source texture is created {with, without} GPUTextureUsage::CopySrc.\n  - the destination texture is created {with, without} GPUTextureUsage::CopyDst.\n* sample count\n  - the sample count of the source texture {is, isn't} equal to the one of the destination texture\n  - when the sample count is greater than 1:\n    - it {is, isn't} a copy of the whole subresource of the source texture.\n    - it {is, isn't} a copy of the whole subresource of the destination texture.\n* texture format\n  - the format of the source texture {is, isn't} equal to the one of the destination texture.\n    - including: depth24plus-stencil8 to/from {depth24plus, stencil8}.\n  - for each depth and/or stencil format: a copy between two textures with same format:\n    - it {is, isn't} a copy of the whole subresource of the {source, destination} texture.\n* copy ranges\n  - if the texture dimension is 2D:\n    - (srcOrigin.x + copyExtent.width) {>, =, <} the width of the subresource size of source\n      textureCopyView.\n    - (srcOrigin.y + copyExtent.height) {>, =, <} the height of the subresource size of source\n      textureCopyView.\n    - (srcOrigin.z + copyExtent.depthOrArrayLayers) {>, =, <} the depthOrArrayLayers of the subresource size of source\n      textureCopyView.\n    - (dstOrigin.x + copyExtent.width) {>, =, <} the width of the subresource size of destination\n      textureCopyView.\n    - (dstOrigin.y + copyExtent.height) {>, =, <} the height of the subresource size of destination\n      textureCopyView.\n    - (dstOrigin.z + copyExtent.depthOrArrayLayers) {>, =, <} the depthOrArrayLayers of the subresource size of destination\n      textureCopyView.\n* when the source and destination texture are the same one:\n  - the set of source texture subresources {has, doesn't have} overlaps with the one of destination\n    texture subresources.\n`;\n\nimport { poptions, params } from '../../../../../common/framework/params_builder.js';\nimport { makeTestGroup } from '../../../../../common/framework/test_group.js';\nimport {\n  kAllTextureFormatInfo,\n  kAllTextureFormats,\n  kCompressedTextureFormats,\n  kDepthStencilFormats,\n  kTextureUsages,\n} from '../../../../capability_info.js';\nimport { align } from '../../../../util/math.js';\nimport { ValidationTest } from '../../validation_test.js';\n\nclass F extends ValidationTest {\n  TestCopyTextureToTexture(\n    source: GPUImageCopyTexture,\n    destination: GPUImageCopyTexture,\n    copySize: GPUExtent3D,\n    isSuccess: boolean\n  ): void {\n    const commandEncoder = this.device.createCommandEncoder();\n    commandEncoder.copyTextureToTexture(source, destination, copySize);\n\n    this.expectValidationError(() => {\n      commandEncoder.finish();\n    }, !isSuccess);\n  }\n\n  GetPhysicalSubresourceSize(\n    textureSize: Required<GPUExtent3DDict>,\n    format: GPUTextureFormat,\n    mipLevel: number\n  ): Required<GPUExtent3DDict> {\n    const virtualWidthAtLevel = Math.max(textureSize.width >> mipLevel, 1);\n    const virtualHeightAtLevel = Math.max(textureSize.height >> mipLevel, 1);\n    const physicalWidthAtLevel = align(\n      virtualWidthAtLevel,\n      kAllTextureFormatInfo[format].blockWidth\n    );\n    const physicalHeightAtLevel = align(\n      virtualHeightAtLevel,\n      kAllTextureFormatInfo[format].blockHeight\n    );\n    return {\n      width: physicalWidthAtLevel,\n      height: physicalHeightAtLevel,\n      depthOrArrayLayers: textureSize.depthOrArrayLayers,\n    };\n  }\n}\n\nexport const g = makeTestGroup(F);\n\ng.test('copy_with_invalid_texture').fn(async t => {\n  const validTexture = t.device.createTexture({\n    size: { width: 4, height: 4, depthOrArrayLayers: 1 },\n    format: 'rgba8unorm',\n    usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.COPY_DST,\n  });\n\n  const errorTexture = t.getErrorTexture();\n\n  t.TestCopyTextureToTexture(\n    { texture: errorTexture },\n    { texture: validTexture },\n    { width: 1, height: 1, depthOrArrayLayers: 1 },\n    false\n  );\n  t.TestCopyTextureToTexture(\n    { texture: validTexture },\n    { texture: errorTexture },\n    { width: 1, height: 1, depthOrArrayLayers: 1 },\n    false\n  );\n});\n\ng.test('mipmap_level')\n  .params([\n    { srcLevelCount: 1, dstLevelCount: 1, srcCopyLevel: 0, dstCopyLevel: 0 },\n    { srcLevelCount: 1, dstLevelCount: 1, srcCopyLevel: 1, dstCopyLevel: 0 },\n    { srcLevelCount: 1, dstLevelCount: 1, srcCopyLevel: 0, dstCopyLevel: 1 },\n    { srcLevelCount: 3, dstLevelCount: 3, srcCopyLevel: 0, dstCopyLevel: 0 },\n    { srcLevelCount: 3, dstLevelCount: 3, srcCopyLevel: 2, dstCopyLevel: 0 },\n    { srcLevelCount: 3, dstLevelCount: 3, srcCopyLevel: 3, dstCopyLevel: 0 },\n    { srcLevelCount: 3, dstLevelCount: 3, srcCopyLevel: 0, dstCopyLevel: 2 },\n    { srcLevelCount: 3, dstLevelCount: 3, srcCopyLevel: 0, dstCopyLevel: 3 },\n  ] as const)\n  .fn(async t => {\n    const { srcLevelCount, dstLevelCount, srcCopyLevel, dstCopyLevel } = t.params;\n\n    const srcTexture = t.device.createTexture({\n      size: { width: 32, height: 32, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_SRC,\n      mipLevelCount: srcLevelCount,\n    });\n    const dstTexture = t.device.createTexture({\n      size: { width: 32, height: 32, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_DST,\n      mipLevelCount: dstLevelCount,\n    });\n\n    const isSuccess = srcCopyLevel < srcLevelCount && dstCopyLevel < dstLevelCount;\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture, mipLevel: srcCopyLevel },\n      { texture: dstTexture, mipLevel: dstCopyLevel },\n      { width: 1, height: 1, depthOrArrayLayers: 1 },\n      isSuccess\n    );\n  });\n\ng.test('texture_usage')\n  .params(\n    params()\n      .combine(poptions('srcUsage', kTextureUsages))\n      .combine(poptions('dstUsage', kTextureUsages))\n  )\n  .fn(async t => {\n    const { srcUsage, dstUsage } = t.params;\n\n    const srcTexture = t.device.createTexture({\n      size: { width: 4, height: 4, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: srcUsage,\n    });\n    const dstTexture = t.device.createTexture({\n      size: { width: 4, height: 4, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: dstUsage,\n    });\n\n    const isSuccess =\n      srcUsage === GPUTextureUsage.COPY_SRC && dstUsage === GPUTextureUsage.COPY_DST;\n\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture },\n      { texture: dstTexture },\n      { width: 1, height: 1, depthOrArrayLayers: 1 },\n      isSuccess\n    );\n  });\n\ng.test('sample_count')\n  .params(\n    params()\n      .combine(poptions('srcSampleCount', [1, 4]))\n      .combine(poptions('dstSampleCount', [1, 4]))\n  )\n  .fn(async t => {\n    const { srcSampleCount, dstSampleCount } = t.params;\n\n    const srcTexture = t.device.createTexture({\n      size: { width: 4, height: 4, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_SRC,\n      sampleCount: srcSampleCount,\n    });\n    const dstTexture = t.device.createTexture({\n      size: { width: 4, height: 4, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_DST,\n      sampleCount: dstSampleCount,\n    });\n\n    const isSuccess = srcSampleCount === dstSampleCount;\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture },\n      { texture: dstTexture },\n      { width: 4, height: 4, depthOrArrayLayers: 1 },\n      isSuccess\n    );\n  });\n\ng.test('multisampled_copy_restrictions')\n  .params(\n    params()\n      .combine(\n        poptions('srcCopyOrigin', [\n          { x: 0, y: 0, z: 0 },\n          { x: 1, y: 0, z: 0 },\n          { x: 0, y: 1, z: 0 },\n          { x: 1, y: 1, z: 0 },\n        ])\n      )\n      .combine(\n        poptions('dstCopyOrigin', [\n          { x: 0, y: 0, z: 0 },\n          { x: 1, y: 0, z: 0 },\n          { x: 0, y: 1, z: 0 },\n          { x: 1, y: 1, z: 0 },\n        ])\n      )\n      .expand(p => poptions('copyWidth', [32 - Math.max(p.srcCopyOrigin.x, p.dstCopyOrigin.x), 16]))\n      .expand(p => poptions('copyHeight', [16 - Math.max(p.srcCopyOrigin.y, p.dstCopyOrigin.y), 8]))\n  )\n  .fn(async t => {\n    const { srcCopyOrigin, dstCopyOrigin, copyWidth, copyHeight } = t.params;\n\n    const kWidth = 32;\n    const kHeight = 16;\n\n    // Currently we don't support multisampled 2D array textures and the mipmap level count of the\n    // multisampled textures must be 1.\n    const srcTexture = t.device.createTexture({\n      size: { width: kWidth, height: kHeight, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_SRC,\n      sampleCount: 4,\n    });\n    const dstTexture = t.device.createTexture({\n      size: { width: kWidth, height: kHeight, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_DST,\n      sampleCount: 4,\n    });\n\n    const isSuccess = copyWidth === kWidth && copyHeight === kHeight;\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture, origin: srcCopyOrigin },\n      { texture: dstTexture, origin: dstCopyOrigin },\n      { width: copyWidth, height: copyHeight, depthOrArrayLayers: 1 },\n      isSuccess\n    );\n  });\n\ng.test('texture_format_equality')\n  .params(\n    params()\n      .combine(poptions('srcFormat', kAllTextureFormats))\n      .combine(poptions('dstFormat', kAllTextureFormats))\n  )\n  .fn(async t => {\n    const { srcFormat, dstFormat } = t.params;\n    const srcFormatInfo = kAllTextureFormatInfo[srcFormat];\n    const dstFormatInfo = kAllTextureFormatInfo[dstFormat];\n    await t.selectDeviceOrSkipTestCase([srcFormatInfo.feature, dstFormatInfo.feature]);\n\n    const kTextureSize = { width: 16, height: 16, depthOrArrayLayers: 1 };\n\n    const srcTexture = t.device.createTexture({\n      size: kTextureSize,\n      format: srcFormat,\n      usage: GPUTextureUsage.COPY_SRC,\n    });\n\n    const dstTexture = t.device.createTexture({\n      size: kTextureSize,\n      format: dstFormat,\n      usage: GPUTextureUsage.COPY_DST,\n    });\n\n    const isSuccess = srcFormat === dstFormat;\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture },\n      { texture: dstTexture },\n      kTextureSize,\n      isSuccess\n    );\n  });\n\ng.test('depth_stencil_copy_restrictions')\n  .params(\n    params()\n      .combine(poptions('format', kDepthStencilFormats))\n      .combine(\n        poptions('copyBoxOffsets', [\n          { x: 0, y: 0, width: 0, height: 0 },\n          { x: 1, y: 0, width: 0, height: 0 },\n          { x: 0, y: 1, width: 0, height: 0 },\n          { x: 0, y: 0, width: -1, height: 0 },\n          { x: 0, y: 0, width: 0, height: -1 },\n        ])\n      )\n      .combine(\n        poptions('srcTextureSize', [\n          { width: 64, height: 64, depthOrArrayLayers: 1 },\n          { width: 64, height: 32, depthOrArrayLayers: 1 },\n          { width: 32, height: 32, depthOrArrayLayers: 1 },\n        ])\n      )\n      .combine(\n        poptions('dstTextureSize', [\n          { width: 64, height: 64, depthOrArrayLayers: 1 },\n          { width: 64, height: 32, depthOrArrayLayers: 1 },\n          { width: 32, height: 32, depthOrArrayLayers: 1 },\n        ])\n      )\n      .combine(poptions('srcCopyLevel', [1, 2]))\n      .combine(poptions('dstCopyLevel', [0, 1]))\n  )\n  .fn(async t => {\n    const {\n      format,\n      copyBoxOffsets,\n      srcTextureSize,\n      dstTextureSize,\n      srcCopyLevel,\n      dstCopyLevel,\n    } = t.params;\n    await t.selectDeviceOrSkipTestCase(kAllTextureFormatInfo[format].feature);\n\n    const kMipLevelCount = 3;\n\n    const srcTexture = t.device.createTexture({\n      size: { width: srcTextureSize.width, height: srcTextureSize.height, depthOrArrayLayers: 1 },\n      format,\n      mipLevelCount: kMipLevelCount,\n      usage: GPUTextureUsage.COPY_SRC,\n    });\n    const dstTexture = t.device.createTexture({\n      size: { width: dstTextureSize.width, height: dstTextureSize.height, depthOrArrayLayers: 1 },\n      format,\n      mipLevelCount: kMipLevelCount,\n      usage: GPUTextureUsage.COPY_DST,\n    });\n\n    const srcSizeAtLevel = t.GetPhysicalSubresourceSize(srcTextureSize, format, srcCopyLevel);\n    const dstSizeAtLevel = t.GetPhysicalSubresourceSize(dstTextureSize, format, dstCopyLevel);\n\n    const copyOrigin = { x: copyBoxOffsets.x, y: copyBoxOffsets.y, z: 0 };\n\n    const copyWidth =\n      Math.min(srcSizeAtLevel.width, dstSizeAtLevel.width) + copyBoxOffsets.width - copyOrigin.x;\n    const copyHeight =\n      Math.min(srcSizeAtLevel.height, dstSizeAtLevel.height) + copyBoxOffsets.height - copyOrigin.y;\n\n    // Depth/stencil copies must copy whole subresources.\n    const isSuccess =\n      copyOrigin.x === 0 &&\n      copyOrigin.y === 0 &&\n      copyWidth === srcSizeAtLevel.width &&\n      copyHeight === srcSizeAtLevel.height &&\n      copyWidth === dstSizeAtLevel.width &&\n      copyHeight === dstSizeAtLevel.height;\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture, origin: { x: 0, y: 0, z: 0 }, mipLevel: srcCopyLevel },\n      { texture: dstTexture, origin: copyOrigin, mipLevel: dstCopyLevel },\n      { width: copyWidth, height: copyHeight, depthOrArrayLayers: 1 },\n      isSuccess\n    );\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture, origin: copyOrigin, mipLevel: srcCopyLevel },\n      { texture: dstTexture, origin: { x: 0, y: 0, z: 0 }, mipLevel: dstCopyLevel },\n      { width: copyWidth, height: copyHeight, depthOrArrayLayers: 1 },\n      isSuccess\n    );\n  });\n\ng.test('copy_ranges')\n  .params(\n    params()\n      .combine(\n        poptions('copyBoxOffsets', [\n          { x: 0, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n          { x: 1, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n          { x: 1, y: 0, z: 0, width: -1, height: 0, depthOrArrayLayers: -2 },\n          { x: 0, y: 1, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n          { x: 0, y: 1, z: 0, width: 0, height: -1, depthOrArrayLayers: -2 },\n          { x: 0, y: 0, z: 1, width: 0, height: 1, depthOrArrayLayers: -2 },\n          { x: 0, y: 0, z: 2, width: 0, height: 1, depthOrArrayLayers: 0 },\n          { x: 0, y: 0, z: 0, width: 1, height: 0, depthOrArrayLayers: -2 },\n          { x: 0, y: 0, z: 0, width: 0, height: 1, depthOrArrayLayers: -2 },\n          { x: 0, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: 1 },\n          { x: 0, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: 0 },\n          { x: 0, y: 0, z: 1, width: 0, height: 0, depthOrArrayLayers: -1 },\n          { x: 0, y: 0, z: 2, width: 0, height: 0, depthOrArrayLayers: -1 },\n        ])\n      )\n      .combine(poptions('srcCopyLevel', [0, 1, 3]))\n      .combine(poptions('dstCopyLevel', [0, 1, 3]))\n  )\n  .fn(async t => {\n    const { copyBoxOffsets, srcCopyLevel, dstCopyLevel } = t.params;\n\n    const kTextureSize = { width: 16, height: 8, depthOrArrayLayers: 3 };\n    const kMipLevelCount = 4;\n    const kFormat = 'rgba8unorm';\n\n    const srcTexture = t.device.createTexture({\n      size: kTextureSize,\n      format: kFormat,\n      mipLevelCount: kMipLevelCount,\n      usage: GPUTextureUsage.COPY_SRC,\n    });\n    const dstTexture = t.device.createTexture({\n      size: kTextureSize,\n      format: kFormat,\n      mipLevelCount: kMipLevelCount,\n      usage: GPUTextureUsage.COPY_DST,\n    });\n\n    const srcSizeAtLevel = t.GetPhysicalSubresourceSize(kTextureSize, kFormat, srcCopyLevel);\n    const dstSizeAtLevel = t.GetPhysicalSubresourceSize(kTextureSize, kFormat, dstCopyLevel);\n\n    const copyOrigin = { x: copyBoxOffsets.x, y: copyBoxOffsets.y, z: copyBoxOffsets.z };\n\n    const copyWidth = Math.max(\n      Math.min(srcSizeAtLevel.width, dstSizeAtLevel.width) + copyBoxOffsets.width - copyOrigin.x,\n      0\n    );\n    const copyHeight = Math.max(\n      Math.min(srcSizeAtLevel.height, dstSizeAtLevel.height) + copyBoxOffsets.height - copyOrigin.y,\n      0\n    );\n    const copyDepth =\n      kTextureSize.depthOrArrayLayers + copyBoxOffsets.depthOrArrayLayers - copyOrigin.z;\n\n    {\n      const isSuccess =\n        copyWidth <= srcSizeAtLevel.width &&\n        copyHeight <= srcSizeAtLevel.height &&\n        copyOrigin.x + copyWidth <= dstSizeAtLevel.width &&\n        copyOrigin.y + copyHeight <= dstSizeAtLevel.height &&\n        copyOrigin.z + copyDepth <= kTextureSize.depthOrArrayLayers;\n\n      t.TestCopyTextureToTexture(\n        { texture: srcTexture, origin: { x: 0, y: 0, z: 0 }, mipLevel: srcCopyLevel },\n        { texture: dstTexture, origin: copyOrigin, mipLevel: dstCopyLevel },\n        { width: copyWidth, height: copyHeight, depthOrArrayLayers: copyDepth },\n        isSuccess\n      );\n    }\n\n    {\n      const isSuccess =\n        copyOrigin.x + copyWidth <= srcSizeAtLevel.width &&\n        copyOrigin.y + copyHeight <= srcSizeAtLevel.height &&\n        copyWidth <= dstSizeAtLevel.width &&\n        copyHeight <= dstSizeAtLevel.height &&\n        copyOrigin.z + copyDepth <= kTextureSize.depthOrArrayLayers;\n\n      t.TestCopyTextureToTexture(\n        { texture: srcTexture, origin: copyOrigin, mipLevel: srcCopyLevel },\n        { texture: dstTexture, origin: { x: 0, y: 0, z: 0 }, mipLevel: dstCopyLevel },\n        { width: copyWidth, height: copyHeight, depthOrArrayLayers: copyDepth },\n        isSuccess\n      );\n    }\n  });\n\ng.test('copy_within_same_texture')\n  .params(\n    params()\n      .combine(poptions('srcCopyOriginZ', [0, 2, 4]))\n      .combine(poptions('dstCopyOriginZ', [0, 2, 4]))\n      .combine(poptions('copyExtentDepth', [1, 2, 3]))\n  )\n  .fn(async t => {\n    const { srcCopyOriginZ, dstCopyOriginZ, copyExtentDepth } = t.params;\n\n    const kArrayLayerCount = 7;\n\n    const testTexture = t.device.createTexture({\n      size: { width: 16, height: 16, depthOrArrayLayers: kArrayLayerCount },\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.COPY_DST,\n    });\n\n    const isSuccess =\n      Math.min(srcCopyOriginZ, dstCopyOriginZ) + copyExtentDepth <=\n      Math.max(srcCopyOriginZ, dstCopyOriginZ);\n    t.TestCopyTextureToTexture(\n      { texture: testTexture, origin: { x: 0, y: 0, z: srcCopyOriginZ } },\n      { texture: testTexture, origin: { x: 0, y: 0, z: dstCopyOriginZ } },\n      { width: 16, height: 16, depthOrArrayLayers: copyExtentDepth },\n      isSuccess\n    );\n  });\n\ng.test('copy_aspects')\n  .desc(\n    `\nTest the validations on the member 'aspect' of GPUImageCopyTexture in CopyTextureToTexture().\n- for all the color and depth-stencil formats: the texture copy aspects must be both 'all'.\n- for all the depth-only formats: the texture copy aspects must be either 'all' or 'depth-only'.\n- for all the stencil-only formats: the texture copy aspects must be either 'all' or 'stencil-only'.\n`\n  )\n  .params(\n    params()\n      .combine(poptions('format', ['rgba8unorm', ...kDepthStencilFormats] as const))\n      .combine(poptions('sourceAspect', ['all', 'depth-only', 'stencil-only'] as const))\n      .combine(poptions('destinationAspect', ['all', 'depth-only', 'stencil-only'] as const))\n  )\n  .fn(async t => {\n    const { format, sourceAspect, destinationAspect } = t.params;\n    await t.selectDeviceOrSkipTestCase(kAllTextureFormatInfo[format].feature);\n\n    const kTextureSize = { width: 16, height: 8, depthOrArrayLayers: 1 };\n\n    const srcTexture = t.device.createTexture({\n      size: kTextureSize,\n      format,\n      usage: GPUTextureUsage.COPY_SRC,\n    });\n    const dstTexture = t.device.createTexture({\n      size: kTextureSize,\n      format,\n      usage: GPUTextureUsage.COPY_DST,\n    });\n\n    // TODO(jiawei.shao@intel.com): get the valid aspects from capability_info.ts.\n    const kValidAspectsForFormat = {\n      rgba8unorm: ['all'],\n\n      // kUnsizedDepthStencilFormats\n      depth24plus: ['all', 'depth-only'],\n      'depth24plus-stencil8': ['all'],\n      'depth24unorm-stencil8': ['all'],\n      'depth32float-stencil8': ['all'],\n\n      // kSizedDepthStencilFormats\n      depth32float: ['all', 'depth-only'],\n      stencil8: ['all', 'stencil-only'],\n      depth16unorm: ['all', 'depth-only'],\n    };\n\n    const isSourceAspectValid = kValidAspectsForFormat[format].includes(sourceAspect);\n    const isDestinationAspectValid = kValidAspectsForFormat[format].includes(destinationAspect);\n\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture, origin: { x: 0, y: 0, z: 0 }, aspect: sourceAspect },\n      { texture: dstTexture, origin: { x: 0, y: 0, z: 0 }, aspect: destinationAspect },\n      kTextureSize,\n      isSourceAspectValid && isDestinationAspectValid\n    );\n  });\n\ng.test('copy_ranges_with_compressed_texture_formats')\n  .params(\n    params()\n      .combine(poptions('format', kCompressedTextureFormats))\n      .combine(\n        poptions('copyBoxOffsets', [\n          { x: 0, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n          { x: 1, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n          { x: 4, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n          { x: 0, y: 0, z: 0, width: -1, height: 0, depthOrArrayLayers: -2 },\n          { x: 0, y: 0, z: 0, width: -4, height: 0, depthOrArrayLayers: -2 },\n          { x: 0, y: 1, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n          { x: 0, y: 4, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n          { x: 0, y: 0, z: 0, width: 0, height: -1, depthOrArrayLayers: -2 },\n          { x: 0, y: 0, z: 0, width: 0, height: -4, depthOrArrayLayers: -2 },\n          { x: 0, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: 0 },\n          { x: 0, y: 0, z: 1, width: 0, height: 0, depthOrArrayLayers: -1 },\n        ])\n      )\n      .combine(poptions('srcCopyLevel', [0, 1, 2]))\n      .combine(poptions('dstCopyLevel', [0, 1, 2]))\n  )\n  .fn(async t => {\n    const { format, copyBoxOffsets, srcCopyLevel, dstCopyLevel } = t.params;\n    await t.selectDeviceOrSkipTestCase(kAllTextureFormatInfo[format].feature);\n\n    const kTextureSize = { width: 60, height: 48, depthOrArrayLayers: 3 };\n    const kMipLevelCount = 4;\n\n    const srcTexture = t.device.createTexture({\n      size: kTextureSize,\n      format,\n      mipLevelCount: kMipLevelCount,\n      usage: GPUTextureUsage.COPY_SRC,\n    });\n    const dstTexture = t.device.createTexture({\n      size: kTextureSize,\n      format,\n      mipLevelCount: kMipLevelCount,\n      usage: GPUTextureUsage.COPY_DST,\n    });\n\n    const srcSizeAtLevel = t.GetPhysicalSubresourceSize(kTextureSize, format, srcCopyLevel);\n    const dstSizeAtLevel = t.GetPhysicalSubresourceSize(kTextureSize, format, dstCopyLevel);\n\n    const copyOrigin = { x: copyBoxOffsets.x, y: copyBoxOffsets.y, z: copyBoxOffsets.z };\n\n    const copyWidth = Math.max(\n      Math.min(srcSizeAtLevel.width, dstSizeAtLevel.width) + copyBoxOffsets.width - copyOrigin.x,\n      0\n    );\n    const copyHeight = Math.max(\n      Math.min(srcSizeAtLevel.height, dstSizeAtLevel.height) + copyBoxOffsets.height - copyOrigin.y,\n      0\n    );\n    const copyDepth =\n      kTextureSize.depthOrArrayLayers + copyBoxOffsets.depthOrArrayLayers - copyOrigin.z;\n\n    const texelBlockWidth = kAllTextureFormatInfo[format].blockWidth;\n    const texelBlockHeight = kAllTextureFormatInfo[format].blockHeight;\n\n    const isSuccessForCompressedFormats =\n      copyOrigin.x % texelBlockWidth === 0 &&\n      copyOrigin.y % texelBlockHeight === 0 &&\n      copyWidth % texelBlockWidth === 0 &&\n      copyHeight % texelBlockHeight === 0;\n\n    {\n      const isSuccess =\n        isSuccessForCompressedFormats &&\n        copyWidth <= srcSizeAtLevel.width &&\n        copyHeight <= srcSizeAtLevel.height &&\n        copyOrigin.x + copyWidth <= dstSizeAtLevel.width &&\n        copyOrigin.y + copyHeight <= dstSizeAtLevel.height &&\n        copyOrigin.z + copyDepth <= kTextureSize.depthOrArrayLayers;\n\n      t.TestCopyTextureToTexture(\n        { texture: srcTexture, origin: { x: 0, y: 0, z: 0 }, mipLevel: srcCopyLevel },\n        { texture: dstTexture, origin: copyOrigin, mipLevel: dstCopyLevel },\n        { width: copyWidth, height: copyHeight, depthOrArrayLayers: copyDepth },\n        isSuccess\n      );\n    }\n\n    {\n      const isSuccess =\n        isSuccessForCompressedFormats &&\n        copyOrigin.x + copyWidth <= srcSizeAtLevel.width &&\n        copyOrigin.y + copyHeight <= srcSizeAtLevel.height &&\n        copyWidth <= dstSizeAtLevel.width &&\n        copyHeight <= dstSizeAtLevel.height &&\n        copyOrigin.z + copyDepth <= kTextureSize.depthOrArrayLayers;\n\n      t.TestCopyTextureToTexture(\n        { texture: srcTexture, origin: copyOrigin, mipLevel: srcCopyLevel },\n        { texture: dstTexture, origin: { x: 0, y: 0, z: 0 }, mipLevel: dstCopyLevel },\n        { width: copyWidth, height: copyHeight, depthOrArrayLayers: copyDepth },\n        isSuccess\n      );\n    }\n  });\n"],"file":"copyTextureToTexture.spec.js"}